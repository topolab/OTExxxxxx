#!/usr/bin/python

import sys
import hashlib
import os

macs= [ [ 0 for i in range(12) ] for j in range(16) ]
macs[1][0]= '20613048'
macs[2][0]= '45085468'
macs[3][0]= '00234823'
macs[4][0]= '60340220'
macs[5][0]= '27551645'
macs[6][0]= '40969061'
macs[7][0]= '07178424'
macs[8][0]= '65867489'
macs[9][0]= '20076842'
macs[10][0]= '49428208'
macs[11][0]= '04639623'
macs[12][0]= '60743082'
macs[13][0]= '27912447'
macs[14][0]= '44300807'
macs[15][0]= '01571220'
macs[1][1]= '75086690'
macs[2][1]= '45674621'
macs[3][1]= '55290692'
macs[4][1]= '25009668'
macs[5][1]= '37607639'
macs[6][1]= '05217662'
macs[7][1]= '17817635'
macs[8][1]= '85286603'
macs[9][1]= '95808672'
macs[10][1]= '69430605'
macs[11][1]= '79050672'
macs[12][1]= '45821644'
macs[13][1]= '57427619'
macs[14][1]= '29071642'
macs[15][1]= '31675611'
macs[1][2]= '37976091'
macs[2][2]= '29054433'
macs[3][2]= '91548281'
macs[4][2]= '32688690'
macs[5][2]= '84992048'
macs[6][2]= '96210444'
macs[7][2]= '48504214'
macs[8][2]= '69494263'
macs[9][2]= '31388031'
macs[10][2]= '63666837'
macs[11][2]= '35570287'
macs[12][2]= '36630210'
macs[13][2]= '88324066'
macs[14][2]= '30842800'
macs[15][2]= '82556278'
macs[1][3]= '63682391'
macs[2][3]= '67582243'
macs[3][3]= '65782979'
macs[4][3]= '69832259'
macs[5][3]= '87892945'
macs[6][3]= '61912837'
macs[7][3]= '89952543'
macs[8][3]= '23042847'
macs[9][3]= '21282553'
macs[10][3]= '65742405'
macs[11][3]= '63902191'
macs[12][3]= '27492491'
macs[13][3]= '45472127'
macs[14][3]= '69152039'
macs[15][3]= '87152705'
macs[1][4]= '80520304'
macs[2][4]= '01384325'
macs[3][4]= '26248826'
macs[4][4]= '57622176'
macs[5][4]= '76780631'
macs[6][4]= '93944014'
macs[7][4]= '12808799'
macs[8][4]= '05146281'
macs[9][4]= '24000942'
macs[10][4]= '47860323'
macs[11][4]= '66928804'
macs[12][4]= '97506918'
macs[13][4]= '10460493'
macs[14][4]= '39620498'
macs[15][4]= '52788191'
macs[1][5]= '05069948'
macs[2][5]= '84266808'
macs[3][5]= '24663929'
macs[4][5]= '09168169'
macs[5][5]= '47365288'
macs[6][5]= '28362948'
macs[7][5]= '66369465'
macs[8][5]= '43660801'
macs[9][5]= '83467722'
macs[10][5]= '68264480'
macs[11][5]= '08261907'
macs[12][5]= '87166547'
macs[13][5]= '25563260'
macs[14][5]= '02160922'
macs[15][5]= '40767841'
macs[1][6]= '94009878'
macs[2][6]= '22247608'
macs[3][6]= '53822013'
macs[4][6]= '49081170'
macs[5][6]= '98686105'
macs[6][6]= '00860511'
macs[7][6]= '51407724'
macs[8][6]= '62668868'
macs[9][6]= '33245873'
macs[10][6]= '81449229'
macs[11][6]= '50084452'
macs[12][6]= '44281153'
macs[13][6]= '35826366'
macs[14][6]= '67064976'
macs[15][6]= '56661321'
macs[1][7]= '69431053'
macs[2][7]= '33428892'
macs[3][7]= '39493248'
macs[4][7]= '00401084'
macs[5][7]= '80478434'
macs[6][7]= '72465215'
macs[7][7]= '54434681'
macs[8][7]= '05442403'
macs[9][7]= '05415891'
macs[10][7]= '15404690'
macs[11][7]= '13475028'
macs[12][7]= '48485888'
macs[13][7]= '24456252'
macs[14][7]= '52443033'
macs[15][7]= '36418443'
macs[1][8]= '79230796'
macs[2][8]= '53630433'
macs[3][8]= '47080386'
macs[4][8]= '01691394'
macs[5][8]= '15047847'
macs[6][8]= '39885748'
macs[7][8]= '23853213'
macs[8][8]= '57462071'
macs[9][8]= '41838926'
macs[10][8]= '25676625'
macs[11][8]= '39424592'
macs[12][8]= '73659102'
macs[13][8]= '67607679'
macs[14][8]= '81809312'
macs[15][8]= '95279061'
macs[1][9]= '05150105'
macs[2][9]= '45400375'
macs[3][9]= '05118035'
macs[4][9]= '35856013'
macs[5][9]= '35524315'
macs[6][9]= '55834143'
macs[7][9]= '75562605'
macs[8][9]= '25684049'
macs[9][9]= '25312725'
macs[10][9]= '25662175'
macs[11][9]= '05330251'
macs[12][9]= '75018237'
macs[13][9]= '35726175'
macs[14][9]= '15016723'
macs[15][9]= '55704021'
macs[1][10]= '03167356'
macs[2][10]= '47524365'
macs[3][10]= '81007810'
macs[4][10]= '25994083'
macs[5][10]= '63493718'
macs[6][10]= '07814125'
macs[7][10]= '41599670'
macs[8][10]= '45880365'
macs[9][10]= '89563832'
macs[10][10]= '27380261'
macs[11][10]= '65847950'
macs[12][10]= '05512903'
macs[13][10]= '49099474'
macs[14][10]= '87870401'
macs[15][10]= '25539190'
macs[1][11]= '60781688'
macs[2][11]= '63447429'
macs[3][11]= '68360482'
macs[4][11]= '61920525'
macs[5][11]= '66047708'
macs[6][11]= '69305925'
macs[7][11]= '64026708'
macs[8][11]= '67080689'
macs[9][11]= '62903082'
macs[10][11]= '65067889'
macs[11][11]= '60382282'
macs[12][11]= '63746381'
macs[13][11]= '68461704'
macs[14][11]= '61323987'
macs[15][11]= '66440700'

zero= [ [ 0 for i in range(8) ] for j in range(2) ]
zero[0][0]= 6
zero[0][1]= 5
zero[0][2]= 4
zero[0][3]= 6
zero[0][4]= 2
zero[0][5]= 6
zero[0][6]= 2
zero[0][7]= 5

list= ['0','1','2','3','4','5','6','7','8','9','A','B','C','D','E','F']

mac= [ [ 0 for i in range(12) ] for j in range(1) ]
hw=raw_input('Insert MAC Address : ')
hw = str.upper(hw)
mac[0][0] = hw[16]
mac[0][1] = hw[15]
mac[0][2] = hw[13]
mac[0][3] = hw[12]
mac[0][4] = hw[10]
mac[0][5] = hw[9]
mac[0][6] = hw[7]
mac[0][7] = hw[6]
mac[0][8] = hw[4]
mac[0][9] = hw[3]
mac[0][10] = hw[1]
mac[0][11] = hw[:1]

table= [ [ 0 for i in range(12) ] for j in range(2) ]

for x in range(0,12):
    for y in list:
        if mac[0][x] == y:
            table[0][x] = macs[int(y , 16)][x];
            
xored= [ [ 0 for i in range(12) ] for j in range(8) ]

for i in range(0,8):
    print i+1
    print "of 8 digits of WPA"
    for x in range(0,12):
        if int(table[0][x]) <> 0:
            a= str(table[0][x])
            a=a[i]
            if int(a) == 0 :
                a = int(a) + 10
            #elif int(a) == 3 :
                #a = int(a) + 10
            #elif int(a) == 5 :
                #a = int(a) + 10
            xored[i][x]= int(a)^zero[0][i]
            print xored[i][x]
            
print 'WPA is:'                   
for i in range(0,8):
    print xored[i][0]^xored[i][1]^xored[i][2]^xored[i][3]^xored[i][4]^xored[i][5]^xored[i][6]^xored[i][7]^xored[i][8]^xored[i][9]^xored[i][10]^xored[i][11]
